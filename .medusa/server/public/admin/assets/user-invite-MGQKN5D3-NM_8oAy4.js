import{u as M}from"./chunk-C76H5USB-DrtEOpci.js";import{u as A,_ as T}from"./chunk-B2JT2FOA-BSXwNWRq.js";import{j as e,b as g,aj as k,ak as D,er as C,H as I,N as P,x as m,I as E,B as F,C as U,r as R,f as L,a3 as f,a1 as v,bm as u,ad as H,g as O,A as z,es as B,T as $,af as q,bo as K}from"./index-BgVe_0kv.js";import"./chunk-GJUPECDU-B_gdUAWI.js";import{K as J}from"./chunk-6HTZNHPT-DYv5rdOA.js";import{R as p}from"./chunk-4TC5YS65-DXocPEx1.js";import{u as Q,a as V,b as G,c as W}from"./chunk-RLY2SL5E-CvKnhDDv.js";import{T as X}from"./Trans-eID9gRRa.js";import{A as Y}from"./arrow-path-C4cEIO9y.js";import{A as Z}from"./alert-2ARz7x3L.js";import"./chunk-YEDAFXMB-obgKcW-e.js";import"./chunk-M3VFKDXJ-5b2kUcOC.js";import"./chunk-AOFGTNG6-BeWYmYwG.js";import"./descending-sorting-DUzSPM8R.js";import"./chunk-EMIHDNB7-ChnLsj58.js";import"./chunk-PFKKVLZX-BUhfDJBx.js";import"./_isIndex-Bg1JWU9r.js";import"./date-picker-B1D_H6c6.js";import"./clsx-B-dksMZM.js";import"./triangle-left-mini-TbLyUVtl.js";var ee=({prefix:s,pageSize:a=20})=>{const t=M(["offset","q","order","created_at","updated_at"],s),{offset:i,created_at:r,updated_at:n,q:o,order:l}=t;return{searchParams:{limit:a,offset:i?Number(i):0,order:l,created_at:r?JSON.parse(r):void 0,updated_at:n?JSON.parse(n):void 0,q:o},raw:t}},se=H({email:q().email()}),y=10,h="usr_invite",ae=`${window.location.origin}/app/invite?token=`,re=()=>{const{t:s}=g(),a=k({defaultValues:{email:""},resolver:D(se)}),{raw:t,searchParams:i}=ee({prefix:h,pageSize:y}),{invites:r,count:n,isPending:o,isError:l,error:c}=Q(i),b=ie(),{table:w}=A({data:r??[],columns:b,count:n,enablePagination:!0,getRowId:d=>d.id,pageSize:y,prefix:h}),{mutateAsync:N,isPending:_}=V(),S=a.handleSubmit(async d=>{try{await N({email:d.email}),a.reset()}catch(x){if(C(x)&&x.status===400){a.setError("root",{type:"manual",message:x.message});return}}});if(l)throw c;return e.jsx(p.Form,{form:a,children:e.jsxs(J,{onSubmit:S,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(p.Header,{}),e.jsx(p.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[e.jsxs("div",{children:[e.jsx(I,{children:s("users.inviteUser")}),e.jsx(P,{size:"small",className:"text-ui-fg-subtle",children:s("users.inviteUserHint")})]}),a.formState.errors.root&&e.jsx(Z,{variant:"error",dismissible:!1,className:"text-balance",children:a.formState.errors.root.message}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsx(m.Field,{control:a.control,name:"email",render:({field:d})=>e.jsxs(m.Item,{children:[e.jsx(m.Label,{children:s("fields.email")}),e.jsx(m.Control,{children:e.jsx(E,{...d})}),e.jsx(m.ErrorMessage,{})]})})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(F,{size:"small",variant:"secondary",type:"submit",isLoading:_,children:s("users.sendInvite")})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(I,{level:"h2",children:s("users.pendingInvites")}),e.jsx(U,{className:"overflow-hidden p-0",children:e.jsx(T,{table:w,columns:b,count:n,pageSize:y,pagination:!0,search:"autofocus",isLoading:o,queryObject:t,prefix:h,orderBy:[{key:"email",label:s("fields.email")},{key:"created_at",label:s("fields.createdAt")},{key:"updated_at",label:s("fields.updatedAt")}]})})]})]})})})]})})},te=({invite:s})=>{const{mutateAsync:a}=G(s.id),{mutateAsync:t}=W(s.id),i=O(),{t:r}=g(),n=async()=>{await i({title:r("general.areYouSure"),description:r("users.deleteInviteWarning",{email:s.email}),cancelText:r("actions.cancel"),confirmText:r("actions.delete")})&&await a()},o=async()=>{await t()},l=()=>{const c=`${ae}${s.token}`;K(c)};return e.jsx(z,{groups:[{actions:[{icon:e.jsx(Y,{}),label:r("users.resendInvite"),onClick:o}]},{actions:[{icon:e.jsx(B,{}),label:r("users.copyInviteLink"),onClick:l}]},{actions:[{icon:e.jsx($,{}),label:r("actions.delete"),onClick:n}]}]})},j=L(),ie=()=>{const{t:s}=g();return R.useMemo(()=>[j.accessor("email",{header:s("fields.email"),cell:({getValue:a})=>a()}),j.accessor("accepted",{header:s("fields.status"),cell:({getValue:a,row:t})=>{const i=a(),r=new Date(t.original.expires_at)<new Date;return i?e.jsx(f,{content:s("users.acceptedOnDate",{date:u(new Date(t.original.updated_at),"dd MMM, yyyy")}),children:e.jsx(v,{color:"green",children:s("users.inviteStatus.accepted")})}):r?e.jsx(f,{content:s("users.expiredOnDate",{date:u(new Date(t.original.expires_at),"dd MMM, yyyy")}),children:e.jsx(v,{color:"red",children:s("users.inviteStatus.expired")})}):e.jsx(f,{content:e.jsx(X,{i18nKey:"users.validFromUntil",components:[e.jsx("span",{className:"font-medium"},"from"),e.jsx("span",{className:"font-medium"},"untill")],values:{from:u(new Date(t.original.created_at),"dd MMM, yyyy"),until:u(new Date(t.original.expires_at),"dd MMM, yyyy")}}),children:e.jsx(v,{color:"orange",children:s("users.inviteStatus.pending")})})}}),j.display({id:"actions",cell:({row:a})=>e.jsx(te,{invite:a.original})})],[s])},Se=()=>e.jsx(p,{children:e.jsx(re,{})});export{Se as Component};
