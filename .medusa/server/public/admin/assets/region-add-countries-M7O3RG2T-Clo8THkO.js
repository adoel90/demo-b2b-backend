import{u as w,a as T,b as E}from"./chunk-NOAFLTPV-5GmFRSB1.js";import{u as A,_ as I}from"./chunk-B2JT2FOA-BSXwNWRq.js";import{$ as F,ei as z,j as o,b as B,r as g,aj as M,ak as D,cZ as H,ek as N,t as x,B as S,ad as K,f as L,M as b,ao as O,af as V}from"./index-BgVe_0kv.js";import"./chunk-GJUPECDU-B_gdUAWI.js";import{K as Z}from"./chunk-6HTZNHPT-DYv5rdOA.js";import{R as n,u as $}from"./chunk-4TC5YS65-DXocPEx1.js";import"./chunk-C76H5USB-DrtEOpci.js";import"./chunk-YEDAFXMB-obgKcW-e.js";import"./chunk-M3VFKDXJ-5b2kUcOC.js";import"./chunk-AOFGTNG6-BeWYmYwG.js";import"./descending-sorting-DUzSPM8R.js";import"./chunk-EMIHDNB7-ChnLsj58.js";import"./chunk-PFKKVLZX-BUhfDJBx.js";import"./_isIndex-Bg1JWU9r.js";import"./date-picker-B1D_H6c6.js";import"./clsx-B-dksMZM.js";import"./triangle-left-mini-TbLyUVtl.js";var q=K({countries:O(V()).min(1)}),m=50,p="ac",G=({region:a})=>{const{t:e}=B(),{handleSuccess:r}=$(),[t,l]=g.useState({}),u=M({defaultValues:{countries:[]},resolver:D(q)}),{setValue:h}=u;g.useEffect(()=>{const s=Object.keys(t).filter(i=>t[i]);h("countries",s,{shouldDirty:!0,shouldTouch:!0})},[t,h]);const{searchParams:j,raw:C}=w({pageSize:m,prefix:p}),{countries:_,count:f}=T({countries:H.map((s,i)=>({display_name:s.display_name,name:s.name,id:i,iso_2:s.iso_2,iso_3:s.iso_3,num_code:s.num_code,region_id:null,region:{}})),...j}),y=U(),{table:R}=A({data:_||[],columns:y,count:f,enablePagination:!0,enableRowSelection:s=>{var i;return((i=a.countries)==null?void 0:i.findIndex(c=>c.iso_2===s.original.iso_2))===-1},getRowId:s=>s.iso_2,pageSize:m,rowSelection:{state:t,updater:l},prefix:p}),{mutateAsync:v,isPending:P}=N(a.id),k=u.handleSubmit(async s=>{var c;const i=[...((c=a.countries)==null?void 0:c.map(d=>d.iso_2))??[],...s.countries];await v({countries:i},{onSuccess:()=>{x.success(e("regions.toast.countries")),r()},onError:d=>{x.error(d.message)}})});return o.jsx(n.Form,{form:u,children:o.jsxs(Z,{onSubmit:k,className:"flex h-full flex-col overflow-hidden",children:[o.jsx(n.Header,{children:o.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[o.jsx(n.Close,{asChild:!0,children:o.jsx(S,{size:"small",variant:"secondary",children:e("actions.cancel")})}),o.jsx(S,{size:"small",isLoading:P,type:"submit",children:e("actions.add")})]})}),o.jsx(n.Body,{className:"overflow-hidden",children:o.jsx(I,{table:R,columns:y,pageSize:m,count:f,search:"autofocus",pagination:!0,layout:"fill",orderBy:[{key:"display_name",label:e("fields.name")},{key:"iso_2",label:e("fields.code")}],queryObject:C,prefix:p})})]})})},Q=L(),U=()=>{const a=E();return g.useMemo(()=>[Q.display({id:"select",header:({table:e})=>o.jsx(b,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:r=>e.toggleAllPageRowsSelected(!!r)}),cell:({row:e})=>{const r=!e.getCanSelect();return o.jsx(b,{checked:e.getIsSelected()||r,disabled:r,onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}}),...a],[a])},pe=()=>{const{id:a}=F(),{region:e,isPending:r,isError:t,error:l}=z(a,{fields:"*payment_providers"});if(t)throw l;return o.jsx(n,{children:!r&&e&&o.jsx(G,{region:e})})};export{pe as Component};
